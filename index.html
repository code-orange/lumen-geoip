<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Lumen GeoIP</title><style>*{box-sizing:border-box}.cxs-display-table{display:table}.cxs-183745076 pre .hljs-number{color:#ff4081}.cxs-3954183383{font-size:24px}.cxs-3377994344{}.cxs-4066908388{clear:both}.cxs-799160745{font-size:48px}.cxs-1246195080{margin-left:-8px;margin-right:-8px}.cxs-857983649{}.cxs-857983649 h1{font-weight:700;letter-spacing:-0.01em;font-size:24px;margin-top:48px;margin-bottom:48px;border-bottom-width:4px;border-bottom-style:solid}.cxs-3147789143{margin-left:-16px;margin-right:-16px}.cxs-857983649 h2{font-weight:700;letter-spacing:-0.01em;font-size:24px;margin-top:48px;margin-bottom:48px;border-bottom-width:4px;border-bottom-style:solid}.cxs-2947628758 ul{padding-left:32px;margin-top:0px;margin-bottom:16px}.cxs-857983649 h3{font-weight:700;letter-spacing:-0.01em;font-size:20px;margin-top:48px;margin-bottom:48px;border-bottom-width:2px;border-bottom-style:solid}.cxs-2947628758 a:hover{text-decoration:underline}.cxs-857983649 h4{font-weight:700;letter-spacing:-0.01em;font-size:20px;margin-top:32px;margin-bottom:8px}.cxs-857983649 h5{font-weight:700;letter-spacing:-0.01em;font-size:20px;margin-top:32px;margin-bottom:8px}.cxs-857983649 h6{font-weight:700;letter-spacing:-0.01em;font-size:20px;margin-top:32px;margin-bottom:8px}.cxs-857983649 p{overflow-x:auto;max-width:40em;margin-top:0px;margin-bottom:16px}.cxs-857983649 code{font-family:Menlo, monospace;font-size:14px;color:#05a}.cxs-857983649 pre{font-family:Menlo, monospace;font-size:14px;overflow-x:auto;padding-top:16px;padding-bottom:16px;margin-top:32px;margin-bottom:32px;border-top:1px solid;border-bottom:1px solid}.cxs-857983649 pre .hljs-keyword{color:#05a}.cxs-857983649 pre .hljs-built_in{color:#444}.cxs-857983649 pre .hljs-type{color:#444}.cxs-857983649 pre .hljs-literal{color:#05a}.cxs-857983649 pre .hljs-number{color:#f30}.cxs-857983649 pre .hljs-regexp{color:#05a}.cxs-857983649 pre .hljs-string{color:#444}.cxs-857983649 pre .hljs-subst{color:#444}.cxs-857983649 pre .hljs-symbol{color:#05a}.cxs-857983649 pre .hljs-class{color:#05a}.cxs-857983649 pre .hljs-function{color:#f30}.cxs-857983649 pre .hljs-title{color:#05a}.cxs-857983649 pre .hljs-params{color:#444}.cxs-857983649 pre .hljs-comment{color:#444}.cxs-857983649 pre .hljs-doctag{color:#444}.cxs-857983649 pre .hljs-meta{color:#444}.cxs-857983649 pre .hljs-meta-keyword{color:#05a}.cxs-857983649 pre .hljs-meta-string{color:#05a}.cxs-857983649 hr{margin-top:48px;margin-bottom:48px;border:0px;border-bottom:2px solid}.cxs-857983649 table{border-collapse:separate;border-spacing:0px;max-width:100%;width:100%}.cxs-857983649 th{text-align:left;line-height:inherit;vertical-align:bottom}.cxs-857983649 td{vertical-align:top;line-height:inherit}.cxs-857983649 img{max-width: 100%;height: auto;margin-top:16px;margin-bottom:16px}.cxs-857983649 a{color:#05a}.cxs-857983649 a:hover{text-decoration:underline}.cxs-857983649 ul{list-style:square inside;padding-left:0px;margin-top:0px;margin-bottom:32px}.cxs-183745076{}.cxs-183745076 h1{font-weight:500;letter-spacing:-0.01em;font-size:48px;margin-top:32px;margin-bottom:8px}.cxs-183745076 h2{font-weight:500;letter-spacing:-0.01em;font-size:24px;margin-top:32px;margin-bottom:8px}.cxs-183745076 h3{font-weight:500;letter-spacing:-0.01em;font-size:20px;margin-top:32px;margin-bottom:8px}.cxs-183745076 h4{font-weight:500;letter-spacing:-0.01em;font-size:16px;margin-top:32px;margin-bottom:8px}.cxs-183745076 h5{font-weight:500;letter-spacing:-0.01em;font-size:14px;margin-top:32px;margin-bottom:8px}.cxs-183745076 h6{font-weight:500;letter-spacing:-0.01em;font-size:12px;margin-top:32px;margin-bottom:8px}.cxs-183745076 p{overflow-x:auto;margin-top:0px;margin-bottom:16px}.cxs-183745076 code{font-family:Menlo, monospace;font-size:14px;padding:4px;background-color:#f5f5f5;border-radius:2px}.cxs-183745076 pre{font-family:Menlo, monospace;font-size:14px;overflow-x:auto;padding:16px;margin-top:8px;margin-bottom:32px;background-color:#f5f5f5;border-radius:2px}.cxs-183745076 pre .hljs-keyword{color:#2196f3}.cxs-183745076 pre .hljs-built_in{color:#1565c0}.cxs-183745076 pre .hljs-type{color:#1565c0}.cxs-183745076 pre .hljs-literal{color:#2196f3}.cxs-2947628758 a{color:#08e;text-decoration: none}.cxs-183745076 pre .hljs-regexp{color:#2196f3}.cxs-183745076 pre .hljs-string{color:#1565c0}.cxs-183745076 pre .hljs-subst{color:#1565c0}.cxs-183745076 pre .hljs-symbol{color:#2196f3}.cxs-183745076 pre .hljs-class{color:#2196f3}.cxs-183745076 pre .hljs-function{color:#ff4081}.cxs-183745076 pre .hljs-title{color:#2196f3}.cxs-183745076 pre .hljs-params{color:#1565c0}.cxs-183745076 pre .hljs-comment{color:#1565c0}.cxs-183745076 pre .hljs-doctag{color:#1565c0}.cxs-183745076 pre .hljs-meta{color:#1565c0}.cxs-183745076 pre .hljs-meta-keyword{color:#2196f3}.cxs-183745076 pre .hljs-meta-string{color:#2196f3}.cxs-183745076 hr{margin-top:48px;margin-bottom:48px;border:0px;border-bottom-style:solid;border-bottom-width:1px;border-bottom:2px solid #e0e0e0}.cxs-183745076 table{border-collapse:separate;border-spacing:0px;max-width:100%;width:100%}.cxs-183745076 th{text-align:left;line-height:inherit;vertical-align:bottom}.cxs-183745076 td{vertical-align:top;line-height:inherit}.cxs-183745076 img{max-width: 100%;height: auto;margin-top:16px;margin-bottom:16px}.cxs-183745076 a{color:#2196f3;text-decoration: none}.cxs-183745076 a:hover{text-decoration:underline}.cxs-183745076 ul{padding-left:32px;margin-top:0px;margin-bottom:16px}.cxs-2947628758{}.cxs-2947628758 h1{font-weight:600;line-height:1.25;font-size:48px;margin-top:32px;margin-bottom:8px}.cxs-2947628758 h2{font-weight:600;line-height:1.25;font-size:24px;margin-top:32px;margin-bottom:8px}.cxs-2947628758 h3{font-weight:600;line-height:1.25;font-size:20px;margin-top:32px;margin-bottom:8px}.cxs-2947628758 h4{font-weight:600;line-height:1.25;font-size:16px;margin-top:32px;margin-bottom:8px}.cxs-2947628758 h5{font-weight:600;line-height:1.25;font-size:14px;margin-top:32px;margin-bottom:8px}.cxs-2947628758 h6{font-weight:600;line-height:1.25;font-size:12px;margin-top:32px;margin-bottom:8px}.cxs-2947628758 p{overflow-x:auto;margin-top:0px;margin-bottom:16px}.cxs-2947628758 code{font-family:Menlo, monospace;font-size:14px;padding:4px;background-color:#eee;border-radius:2px}.cxs-2947628758 pre{font-family:Menlo, monospace;font-size:14px;overflow-x:auto;padding:16px;margin-top:8px;margin-bottom:32px;background-color:#eee;border-radius:2px}.cxs-2947628758 pre .hljs-keyword{color:#08e}.cxs-2947628758 pre .hljs-built_in{color:#059}.cxs-2947628758 pre .hljs-type{color:#059}.cxs-2947628758 pre .hljs-literal{color:#08e}.cxs-2947628758 pre .hljs-number{color:#e08}.cxs-2947628758 pre .hljs-regexp{color:#08e}.cxs-2947628758 pre .hljs-string{color:#059}.cxs-2947628758 pre .hljs-subst{color:#059}.cxs-2947628758 pre .hljs-symbol{color:#08e}.cxs-2947628758 pre .hljs-class{color:#08e}.cxs-2947628758 pre .hljs-function{color:#e08}.cxs-2947628758 pre .hljs-title{color:#08e}.cxs-2947628758 pre .hljs-params{color:#059}.cxs-2947628758 pre .hljs-comment{color:#059}.cxs-2947628758 pre .hljs-doctag{color:#059}.cxs-2947628758 pre .hljs-meta{color:#059}.cxs-2947628758 pre .hljs-meta-keyword{color:#08e}.cxs-2947628758 pre .hljs-meta-string{color:#08e}.cxs-2947628758 hr{margin-top:48px;margin-bottom:48px;border:0px;border-bottom-style:solid;border-bottom-width:1px;border-bottom:2px solid #ddd}.cxs-2947628758 table{border-collapse:separate;border-spacing:0px;max-width:100%;width:100%}.cxs-2947628758 th{text-align:left;line-height:inherit;vertical-align:bottom}.cxs-2947628758 td{vertical-align:top;line-height:inherit}.cxs-2947628758 img{max-width: 100%;height: auto;margin-top:16px;margin-bottom:16px}.cxs-3377994344:hover{box-shadow:inset 0 0 0 999px rgba(0, 0, 0, .125)}@media screen and (min-width: 52em) { .cxs-799160745{font-size:72px} }@media screen and (min-width:52em) { .cxs-857983649 h3{font-size:24px} }@media screen and (min-width:52em) { .cxs-857983649 h2{font-size:48px} }@media screen and (min-width:52em) { .cxs-857983649 h1{font-size:48px} }@media screen and (min-width: 52em) { .cxs-3954183383{} }</style></head><body style="margin:0;"><div class="Xv" style="font-family:-apple-system, BlinkMacSystemFont, sans-serif;font-weight:400;line-height:1.5;color:#111;background-color:#fff;"><nav style="display:flex;align-items:center;padding-top:8px;padding-bottom:8px;padding-left:16px;padding-right:16px;background-color:#fff;"><a href="https://github.com/code-orange/lumen-geoip" class="Link" style="box-sizing:border-box;color:inherit;display:inline-block;font-size:14px;line-height:16px;padding-left:16px;padding-right:16px;padding-top:16px;padding-bottom:16px;font-weight:600;text-decoration:none;">GitHub</a></nav><header class="BannerHeader" style="display:flex;align-items:center;justify-content:center;text-align:left;min-height:100vh;color:white;background-color:#111;background-image:url(undefined);background-size:cover;background-position:center;"><div style="box-sizing:border-box;width:100%;max-width:1024px;margin-left:auto;margin-right:auto;padding-top:48px;padding-bottom:48px;padding-left:32px;padding-right:32px;"><h1 class="cxs-799160745" style="box-sizing:border-box;font-weight:600;line-height:1.25;margin:0;">lumen-geoip</h1><h2 class="cxs-3954183383" style="box-sizing:border-box;font-weight:600;line-height:1.25;margin:0;">GeoIP for Lumen</h2><div class="cxs-1246195080" style="box-sizing:border-box;padding-top:16px;padding-bottom:16px;"><iframe src="https://platform.twitter.com/widgets/tweet_button.html?text=lumen-geoip%3A%20GeoIP%20for%20Lumen&amp;url=&amp;via=&amp;hashtags=&amp;size=" height="20" allowtransparency="true" frameborder="0" scrolling="no" style="box-sizing:border-box;width:61px;overflow:hidden;margin:8px;"></iframe><iframe src="https://ghbtns.com/github-btn.html?type=star&amp;count=true&amp;user=code-orange&amp;repo=lumen-geoip&amp;size=" height="20" frameborder="0" scrolling="no" style="box-sizing:border-box;width:100px;overflow:hidden;margin:8px;"></iframe><div class="cxs-4066908388 cxs-display-table"></div></div></div></header><div class="cxs-2947628758" style="box-sizing:border-box;max-width:1024px;margin-left:auto;margin-right:auto;padding-top:32px;padding-bottom:32px;padding-left:32px;padding-right:32px;"><article style="box-sizing:border-box;"><div><h1>GeoIP for Lumen</h1>
<p><a href="https://packagist.org/packages/code-orange/lumen-geoip"><img src="https://poser.pugx.org/code-orange/lumen-geoip/v/stable" /></a> <a href="https://packagist.org/packages/code-orange/lumen-geoip"><img src="https://poser.pugx.org/code-orange/lumen-geoip/downloads" /></a> <a href="https://packagist.org/packages/code-orange/lumen-geoip"><img src="https://poser.pugx.org/code-orange/lumen-geoip/license" /></a> <a href="https://packagist.org/packages/code-orange/lumen-geoip"><img src="https://poser.pugx.org/code-orange/lumen-geoip/composerlock" /></a></p>
<p>Determine the geographical location of website visitors based on their IP addresses.</p>
<h2>Installation</h2>
<p>To install this package, just install through composer</p>
<pre>$ composer <span class="hljs-meta">require</span> <span class="hljs-meta">code</span>-orange/lumen-geoip</pre><h3>Providers</h3>
<p>Next, open <code>bootstrap/app.php</code> and add under the Register Service Providers section:</p>
<pre>...
$app-&gt;register(CodeOrange\GeoIP\GeoIPServiceProvider::class);</pre><h3>Update MaxMind GeoLite2 City database</h3>
<p>Run this on the command line from the root of your project:</p>
<pre><span class="hljs-variable">$ </span>php artisan <span class="hljs-symbol">geoip:</span>update</pre><h3>Usage</h3>
<p>GeoIP will try to determine the IP using the following http headers: <code>HTTP_CLIENT_IP</code>, <code>HTTP_X_FORWARDED_FOR</code>, <code>HTTP_X_FORWARDED</code>, <code>HTTP_X_CLUSTER_CLIENT_IP</code>, <code>HTTP_FORWARDED_FOR</code>, <code>HTTP_FORWARDED</code>, <code>REMOTE_ADDR</code> in this order.  Optionally you can set an IP as the only parameter to set it.</p>
<pre>$record = app()-&gt;geoip-&gt;getLocation(<span class="hljs-string">'232.223.11.11'</span>);
$record = GeoIP::getLocation(<span class="hljs-string">'232.223.11.11'</span>); <span class="hljs-comment">// If you have enabled facades</span>

<span class="hljs-keyword">print</span>($record-&gt;country-&gt;isoCode . <span class="hljs-string">&quot;\n&quot;</span>); <span class="hljs-comment">// 'US'</span>
<span class="hljs-keyword">print</span>($record-&gt;country-&gt;name . <span class="hljs-string">&quot;\n&quot;</span>); <span class="hljs-comment">// 'United States'</span>
<span class="hljs-keyword">print</span>($record-&gt;country-&gt;names[<span class="hljs-string">'zh-CN'</span>] . <span class="hljs-string">&quot;\n&quot;</span>); <span class="hljs-comment">// '美国'</span>

<span class="hljs-keyword">print</span>($record-&gt;mostSpecificSubdivision-&gt;name . <span class="hljs-string">&quot;\n&quot;</span>); <span class="hljs-comment">// 'Minnesota'</span>
<span class="hljs-keyword">print</span>($record-&gt;mostSpecificSubdivision-&gt;isoCode . <span class="hljs-string">&quot;\n&quot;</span>); <span class="hljs-comment">// 'MN'</span>

<span class="hljs-keyword">print</span>($record-&gt;city-&gt;name . <span class="hljs-string">&quot;\n&quot;</span>); <span class="hljs-comment">// 'Minneapolis'</span>

<span class="hljs-keyword">print</span>($record-&gt;postal-&gt;code . <span class="hljs-string">&quot;\n&quot;</span>); <span class="hljs-comment">// '55455'</span>

<span class="hljs-keyword">print</span>($record-&gt;location-&gt;latitude . <span class="hljs-string">&quot;\n&quot;</span>); <span class="hljs-comment">// 44.9733</span>
<span class="hljs-keyword">print</span>($record-&gt;location-&gt;longitude . <span class="hljs-string">&quot;\n&quot;</span>); <span class="hljs-comment">// -93.2323</span></pre><h3>Other Methods</h3>
<p>These methods are also available to use within your applications.</p>
<pre>app()-&gt;geoip-&gt;checkIp($ip) <span class="hljs-comment">// Checks IP to make sure IP is a valid IPv4 or IPv6 address and not within a private or reserved range</span>
app()-&gt;geoip-&gt;getIp() <span class="hljs-comment">// Returns the detected client IP</span></pre><h3>Default Location Data</h3>
<p>When an IP is not detected it will be set to 127.0.0.1 which will ultimately throw an Exception.  If you are not in production your record will default to the following data.</p>
<pre><span class="hljs-keyword">array</span> (
    <span class="hljs-string">&quot;ip&quot;</span>           =&gt; <span class="hljs-string">&quot;232.223.11.11&quot;</span>,
    <span class="hljs-string">&quot;isoCode&quot;</span>      =&gt; <span class="hljs-string">&quot;US&quot;</span>,
    <span class="hljs-string">&quot;country&quot;</span>      =&gt; <span class="hljs-string">&quot;United States&quot;</span>,
    <span class="hljs-string">&quot;city&quot;</span>         =&gt; <span class="hljs-string">&quot;New Haven&quot;</span>,
    <span class="hljs-string">&quot;state&quot;</span>        =&gt; <span class="hljs-string">&quot;CT&quot;</span>,
    <span class="hljs-string">&quot;postal_code&quot;</span>  =&gt; <span class="hljs-string">&quot;06510&quot;</span>,
    <span class="hljs-string">&quot;lat&quot;</span>          =&gt; <span class="hljs-number">41.28</span>,
    <span class="hljs-string">&quot;lon&quot;</span>          =&gt; <span class="hljs-number">-72.88</span>,
    <span class="hljs-string">&quot;timezone&quot;</span>     =&gt; <span class="hljs-string">&quot;America/New_York&quot;</span>,
    <span class="hljs-string">&quot;continent&quot;</span>    =&gt; <span class="hljs-string">&quot;NA&quot;</span>,
    <span class="hljs-string">&quot;default&quot;</span>      =&gt; <span class="hljs-keyword">false</span>
);</pre><h2>Change Log</h2>
<h4>v3.0.0</h4>
<ul>
<li>Added support for Lumen 5.5</li>
</ul>
<h4>v2.0.0</h4>
<ul>
<li>Simplified namespace</li>
<li>Added Facade support</li>
<li>Added default location when in development</li>
<li>Fixed bug where detected IP was always blank</li>
</ul>
</div></article></div><footer><div style="box-sizing:border-box;max-width:1024px;margin-left:auto;margin-right:auto;margin-bottom:32px;padding-top:8px;padding-bottom:8px;padding-left:32px;padding-right:32px;"><div style="margin-left:-16px;margin-right:-16px;"><a href="https://github.com/code-orange/lumen-geoip" class="Link" style="box-sizing:border-box;color:inherit;display:inline-block;font-size:14px;line-height:16px;padding-left:16px;padding-right:16px;padding-top:16px;padding-bottom:16px;font-weight:600;text-decoration:none;">GitHub</a><a href="https://github.com/code-orange" class="Link" style="box-sizing:border-box;color:inherit;display:inline-block;font-size:14px;line-height:16px;padding-left:16px;padding-right:16px;padding-top:16px;padding-bottom:16px;font-weight:600;text-decoration:none;">code-orange</a></div><div></div></div></footer></div><div style="font-family:-apple-system, sans-serif;font-size:12px;font-weight:600;text-align:right;padding:24px;color:#333;background-color:#eee;"><a href="http://compositor.io" style="color:inherit;text-decoration:none;">Built with Compositor.io</a></div></body></html>